{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>University - {{ university.university_name }}</title>
    <link rel="stylesheet" href="{% static 'university.css' %}">
    <link href='https://fonts.googleapis.com/css?family=Inter' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
    <!-- Add jQuery for AJAX operations -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <div class="dashh_main_sec">
    <div class="dashh_mainsidebar">
        <div class="dashh_mainlogo">
            <img src="{% static 'images/universitylogo.svg' %}" alt="{{ university.university_name }} Logo">
            <h2>{{ university.university_name }}<br><span>{{ university.university_location }}</span></h2>
        </div>
        <hr class="dashh_logo_line">
        <ul>
            <li><a href="{% url 'university' %}" class="{% if active_page == 'university' %}active{% endif %}">
                <img src="{% static 'images/dash_mainicon.svg' %}" alt=""> University
            </a></li>
            <li><a href="{% url 'referral_code' %}" class="{% if active_page == 'referral' %}active{% endif %}">
                <img src="{% static 'images/chain.svg' %}" alt="refcode" class="sidelogo"> Referral Code
            </a></li>
            <li><a href="{% url 'registered_students' %}" class="{% if active_page == 'students' %}active{% endif %}">
                <img src="{% static 'images/candidateprofile.svg' %}" alt="regstudent" class="sidelogo"> Registered Students
            </a></li>
            <li><a href="{% url 'professor_list' %}" class="{% if active_page == 'professors' %}active{% endif %}">
                <img src="{% static 'images/professoruser.svg' %}" alt="professor" class="sidelogo"> Professor
            </a></li>
            <li><a href="{% url 'course_list' %}" class="{% if active_page == 'courses' %}active{% endif %}">
                <img src="{% static 'images/course-icon.svg' %}" alt="course" class="sidelogo"> Course
            </a></li>
            <li><a href="{% url 'difficulty_list' %}" class="{% if active_page == 'difficulty' %}active{% endif %}">
                <img src="{% static 'images/difficulty.svg' %}" alt="difficulty" class="sidelogo"> Difficulty
            </a></li>
            <li><a href="{% url 'exam_list' %}" class="{% if active_page == 'exams' %}active{% endif %}">
                <img src="{% static 'images/examm.svg' %}" alt="exam" class="sidelogo"> Exam
            </a></li>
            <li><a href="{% url 'result_list' %}" class="{% if active_page == 'results' %}active{% endif %}">
                <img src="{% static 'images/clipboard.svg' %}" alt="exam" class="sidelogo"> Result
            </a></li>
        </ul>
    </div>
    
    <div class="dashh_mainmain-content">
        <!-- Messages section for displaying feedback -->
        {% if messages %}
        <div class="messages">
            {% for message in messages %}
            <div class="message {% if message.tags %}{{ message.tags }}{% endif %}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- UNIVERSITY SECTION -->
        {% if active_page == 'university' %}
        <div id="dashh_maindashboard" class="dashh_mainpage">
            <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">University</h2>
            
            <div class="dashh_mainstats">
                <div class="dashh_maincard">
                    <p class="dashh_mainrd1">Total Students</p>
                    <p class="dashh_mainnum">{{ stats.total_students }}</p>
                </div>
                <div class="dashh_maincard">
                    <p class="dashh_mainrd1">Approved Students</p>
                    <p class="dashh_mainnum">{{ stats.approved_students }}</p>
                </div>
                <div class="dashh_maincard">
                    <p class="dashh_mainrd1">Rejected Students</p>
                    <p class="dashh_mainnum">{{ stats.rejected_students }}</p>
                </div>
                <div class="dashh_maincard">
                    <p class="dashh_mainrd1">Pending Students</p>
                    <p class="dashh_mainnum">{{ stats.pending_students }}</p>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- REFERRAL CODE SECTION -->
        {% if active_page == 'referral' %}
        <div id="dashh_mainreferral" class="dashh_mainpage">
            <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Referral Code</h2>
            <div class="dashh_mainreferral-container">
                <img src="{% static 'images/highlightchain.svg' %}" alt="">
                <div>
                    <p class="dashh_mainreferral-code">{{ referral_code }}</p>
                    <p class="dashh_mainreferral-note"><span>*</span>This referral code is generated only once by the platform and should be filled at the time of registration by students.</p>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- REGISTERED STUDENTS SECTION -->
        {% if active_page == 'students' %}
        <div id="dashh_mainstudents" class="dashh_mainpage">
            <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Registered Students</h2>
            <p class="dashh_mainreferral-note"><span>*</span>This is the list of students who are registered using the respective Referral Code.</p>
            <div class="dashh_mainregistered-container">
                <table class="dashh_mainstudents-table">
                    <tr>
                        <th>S.No</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone no.</th>
                        <th>College Name</th>
                        <th>Referral Code</th>
                        <th>Status</th>
                    </tr>
                    {% for student in students %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ student.name }}</td>
                        <td>{{ student.email }}</td>
                        <td>{{ student.phone }}</td>
                        <td>{{ student.college }}</td>
                        <td>{{ student.referral_code }}</td>
                        <td>
                            {% if student.status == 'Pending' %}
                            <span class="dashh_mainstatus-badge dashh_mainstatus-pending">Pending <img src="{% static 'images/wall-clock 1.svg' %}" alt=""></span>
                            {% elif student.status == 'Approved' %}
                            <span class="dashh_mainstatus-badge dashh_mainstatus-approved">Approved <img src="{% static 'images/approve 2.svg' %}" alt=""></span>
                            {% elif student.status == 'Rejected' %}
                            <span class="dashh_mainstatus-badge dashh_mainstatus-rejected">Rejected <img src="{% static 'images/close 1.svg' %}" alt=""></span>
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" class="no-data">No students registered yet.</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
        {% endif %}

        <!-- PROFESSORS LIST SECTION -->
        {% if active_page == 'professors' %}
        <div id="dashh_mainprofessors" class="dashh_mainpage">
           <div class="headinggg_dash_professor">
            <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Professor list</h2>
            <a href="{% url 'add_professor' %}" class="add-professor-btn">
                + Add Professor
            </a>
           </div>
            <p class="dashh_mainreferral-note"><span>*</span>This is the list of professors already listed on the dashboard.</p>
            
            <div class="dashh_mainregistered-container">
                <table class="dashh_mainstudents-table">
                    <tr>
                        <th>S.No</th>
                        <th>Professor id</th>
                        <th>Professor Name</th>
                        <th>Email</th>
                        <th>Phone no.</th>
                        <th>Action</th>
                    </tr>
                    {% for professor in professors %}
                    <tr id="professor-row-{{ professor.id }}">
                        <td>{{ forloop.counter }}</td>
                        <td>{{ professor.professor_code }}</td>
                        <td>{{ professor.name }}</td>
                        <td>{{ professor.email }}</td>
                        <td>9876543210</td>
                        <td>
                            <a href="#" onclick="editProfessor({{ professor.id }})" class="edit-btn">
                                <img src="{% static 'images/editbutton.svg' %}" alt="edit" class="editt">
                            </a>
                            <a href="#" onclick="deleteProfessor({{ professor.id }})" class="delete-btn">
                                <img src="{% static 'images/deletebutton.svg' %}" alt="delete" class="editt">
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="no-data">No professors added yet.</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
        {% endif %}

        <!-- ADD PROFESSOR SECTION -->
        {% if active_page == 'add_professor' %}
        <div id="dashh_mainprofessor" class="dashh_mainpage">
            <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Professor</h2>
        
            <div class="dashh_mainprofessor-container">
                <form id="professorForm" method="post" action="{% url 'add_professor' %}">
                    {% csrf_token %}
                    <div class="dashh_mainprofessor-form">
                        <label>Professor name</label>
                        <div class="input-container">
                            <img src="{% static 'images/userproff.svg' %}" alt="user">
                            <input type="text" name="professor_name" placeholder="Enter Professor name" required>
                        </div>
                    </div>
                   
                    <div class="dashh_mainprofessor-form">
                        <label>Email id</label>
                        <div class="input-container">
                            <input type="email" name="email" placeholder="Enter Email id" required>
                        </div>
                    </div>
                    <div class="dashh_mainprofessor-form">
                        <label>Password</label>
                        <div class="input-container">
                            <img src="{% static 'images/lock.svg' %}" alt="lock">
                            <input type="password" name="password" placeholder="Enter password" required>
                        </div>
                    </div>
                    <div class="button-container">
                        <button type="submit" class="add-professor-btn">Add Professor</button>
                    </div>
                </form>
            </div>
        </div>
        {% endif %}

        <!-- EDIT PROFESSOR SECTION -->
        {% if active_page == 'edit_professor' %}
        <div id="edit_professor" class="dashh_mainpage">
            <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Edit Professor</h2>
        
            <div class="dashh_mainprofessor-container">
                <form id="editProfessorForm" method="post" action="{% url 'edit_professor' professor.id %}">
                    {% csrf_token %}
                    <div class="dashh_mainprofessor-form">
                        <label>Professor name</label>
                        <div class="input-container">
                            <img src="{% static 'images/userproff.svg' %}" alt="user">
                            <input type="text" name="professor_name" value="{{ professor.name }}" required>
                        </div>
                    </div>
                   
                    <div class="dashh_mainprofessor-form">
                        <label>Email id</label>
                        <div class="input-container">
                            <input type="email" name="email" value="{{ professor.email }}" required>
                        </div>
                    </div>
                    <div class="dashh_mainprofessor-form">
                        <label>Password</label>
                        <div class="input-container">
                            <img src="{% static 'images/lock.svg' %}" alt="lock">
                            <input type="password" name="password" placeholder="Enter new password to change">
                        </div>
                    </div>
                    <div class="button-container">
                        <button type="submit" class="add-professor-btn">Update Professor</button>
                    </div>
                </form>
            </div>
        </div>
        {% endif %}

        <!-- COURSES LIST SECTION -->
        {% if active_page == 'courses' %}
        <div id="dashh_maindashh_list" class="dashh_mainpage">
            <div class="headinggg_dash_professor">
                <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Course list</h2>
                <a href="{% url 'add_course' %}" class="add-professor-btn">
                    + Add Course
                </a>
            </div>
            <p class="dashh_mainreferral-note"><span>*</span>This is the list Courses already listed on the dashboard.</p>
            
            <div class="dashh_maindashh_list">
                <table class="dashh_mainstudents-table">
                    <tr>
                        <th>S.No</th>
                        <th>Course id</th>
                        <th>Course Name</th>
                        <th>Action</th>
                    </tr>
                    {% for course in courses %}
                    <tr id="course-row-{{ course.id }}">
                        <td>{{ forloop.counter }}</td>
                        <td>{{ course.course_code }}</td>
                        <td>{{ course.name }}</td>
                        <td>
                            <a href="#" onclick="editCourse({{ course.id }})" class="edit-btn">
                                <img src="{% static 'images/editbutton.svg' %}" alt="edit" class="editt">
                            </a>
                            <a href="#" onclick="deleteCourse({{ course.id }})" class="delete-btn">
                                <img src="{% static 'images/deletebutton.svg' %}" alt="delete" class="editt">
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="no-data">No courses added yet.</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
        {% endif %}

        <!-- ADD COURSE SECTION -->
        {% if active_page == 'add_course' %}
        <div id="dashh_course" class="dashh_mainpage">
            <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Course</h2>
        
            <div class="dashh_mainprofessor-container">
                <form id="courseForm" method="post" action="{% url 'add_course' %}">
                    {% csrf_token %}
                    <div class="dashh_mainprofessor-form">
                        <label>Course name</label>
                        <div class="input-container">
                            <img src="{% static 'images/userproff.svg' %}" alt="user">
                            <input type="text" name="course_name" placeholder="Enter Course name" required>
                        </div>
                    </div>
                    <div class="button-container">
                        <button type="submit" class="add-professor-btn">Add Course</button>
                    </div>
                </form>
            </div>
        </div>
        {% endif %}

        <!-- EDIT COURSE SECTION -->
        {% if active_page == 'edit_course' %}
        <div id="edit_course" class="dashh_mainpage">
            <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Edit Course</h2>
        
            <div class="dashh_mainprofessor-container">
                <form id="editCourseForm" method="post" action="{% url 'edit_course' course.id %}">
                    {% csrf_token %}
                    <div class="dashh_mainprofessor-form">
                        <label>Course name</label>
                        <div class="input-container">
                            <img src="{% static 'images/userproff.svg' %}" alt="user">
                            <input type="text" name="course_name" value="{{ course.name }}" required>
                        </div>
                    </div>
                    <div class="button-container">
                        <button type="submit" class="add-professor-btn">Update Course</button>
                    </div>
                </form>
            </div>
        </div>
        {% endif %}

        <!-- DIFFICULTY SECTION -->
        {% if active_page == 'difficulty' %}
        <div id="dashh_diff" class="dashh_mainpage">
            <div class="headinggg_dash_professor">
                <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Difficulty Level</h2>
            </div>
            <p class="dashh_mainreferral-note"><span>*</span>Add an appropriate difficulty level for the exam to tailor the questions to match the desired challenge.</p>

            <!-- Add Difficulty Form -->
            <div class="dashh_mainprofessor-container difficulty-form-container">
                <div class="dashh_mainprofessor-form difficulty-form">
                    <label>Difficulty name</label>
                    <div class="input-container">
                        <input type="text" id="difficultyInput" placeholder="+ Add Difficulty name">
                    </div>
                </div>
                <div class="diffdiv">
                    <button class="add-diff-btn add-professor-btn" id="addDifficultyBtn">
                        + Add Difficulty
                    </button>
                </div>
            </div>

            <!-- Difficulty Table -->
            <div class="difficulty-table-container">
                <table class="dashh_mainstudents-table">
                    <thead>
                        <tr>
                            <th>S.no.</th>
                            <th>Difficulty name</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="difficultyTableBody">
                        {% for difficulty in difficulties %}
                        <tr id="difficulty-row-{{ difficulty.id }}">
                            <td>{{ forloop.counter }}</td>
                            <td>{{ difficulty.difficulty_name }}</td>
                            <td>
                                <button class="edit-btn" onclick="editDifficulty({{ difficulty.id }})">Edit</button>
                                <button class="delete-btn" onclick="deleteDifficulty({{ difficulty.id }})">Delete</button>
                            </td>
                        </tr>
                        {% empty %}
                        <tr id="no-difficulties">
                            <td colspan="3" class="no-data">No difficulty levels added yet.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}

        <!-- EXAMS SECTION -->
        {% if active_page == 'exams' %}
        <div id="dashh_exam" class="dashh_mainpage">
            <div class="headinggg_dash_professor">
                <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Exam</h2>
                <a href="{% url 'add_exam' %}" class="add-professor-btn">
                    + Add Exam
                </a>
            </div>
            <p class="dashh_mainreferral-note"><span>*</span>This is the list of exams already listed on the dashboard.</p>
            
            <div class="dashh_mainregistered-container">
                <table class="dashh_mainstudents-table">
                    <tr>
                        <th>S.No</th>
                        <th>Exam code</th>
                        <th>Professor</th>
                        <th>Course</th>
                        <th>Difficulty</th>
                        <th>No. of ques.</th>
                        <th>Duration</th>
                        <th>Start time</th>
                        <th>End time</th>
                        <th>Action</th>
                    </tr>
                    {% for exam in exams %}
                    <tr id="exam-row-{{ exam.id }}">
                        <td>{{ forloop.counter }}</td>
                        <td>{{ exam.exam_code }}</td>
                        <td>{{ exam.professor.name }}</td>
                        <td>{{ exam.course.name }}</td>
                        <td>{{ exam.difficulty.difficulty_name }}</td>
                        <td>{{ exam.num_questions }}</td>
                        <td>{{ exam.duration }} min</td>
                        <td>{{ exam.start_time|date:"d/m/Y H:i" }}</td>
                        <td>{{ exam.end_time|date:"d/m/Y H:i" }}</td>
                        <td>
                            <div class="action_btn">
                                <a href="#" onclick="openEditExamModal({{ exam.id }})" class="edit-btn">
                                    <img src="{% static 'images/edittexm.svg' %}" alt="edit" class="editt">
                                </a>
                                <a href="#" onclick="updateQuestions({{ exam.id }})" class="update-btn">
                                    <img src="{% static 'images/updateexam.svg' %}" alt="update" class="editt">
                                </a>
                                <a href="{% url 'start_exam' exam.id %}" class="start-btn">Start</a>
                            </div>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="10" class="no-data">No exams created yet.</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
        {% endif %}

        <!-- ADD EXAM SECTION -->
        {% if active_page == 'add_exam' %}
        <div id="dashh_mainexam" class="dashh_mainpage">
            <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Exam</h2>

            <div class="dashh_mainprofessor-container">
                <form id="examForm" method="post" action="{% url 'add_exam' %}">
                    {% csrf_token %}
                    <div class="dashh_mainprofessor-form">
                        <label>Select Professor</label>
                        <div class="input-container">
                            <select name="professor" required>
                                <option value="">Select Professor</option>
                                {% for professor in professors %}
                                <option value="{{ professor.id }}">{{ professor.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="dashh_mainprofessor-form">
                        <label>Select Course</label>
                        <div class="input-container">
                            <select name="course" required>
                                <option value="">Select Course</option>
                                {% for course in courses %}
                                <option value="{{ course.id }}">{{ course.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="dashh_mainprofessor-form">
                        <label>Select Difficulty Level</label>
                        <div class="input-container">
                            <select name="difficulty" required>
                                <option value="">Select Difficulty</option>
                                {% for difficulty in difficulties %}
                                <option value="{{ difficulty.id }}">{{ difficulty.difficulty_name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="dashh_mainprofessor-form">
                        <label>No. of Ques.</label>
                        <div class="input-container">
                            <input type="number" name="num_questions" min="1" placeholder="Enter no of questions" required>
                        </div>
                    </div>
                    <div class="dashh_mainprofessor-form">
                        <label>Exam Duration (minutes)</label>
                        <div class="input-container">
                            <input type="number" name="duration" min="5" placeholder="Enter exam duration in minutes" required>
                        </div>
                    </div>
                    <div class="dashh_mainprofessor-form">
                        <label>Start Time</label>
                        <div class="input-container">
                            <input type="datetime-local" name="start_time" required>
                        </div>
                    </div>
                    <div class="dashh_mainprofessor-form">
                        <label>End Time</label>
                        <div class="input-container">
                            <input type="datetime-local" name="end_time" required>
                        </div>
                    </div>
                    <div class="button-container">
                        <button type="submit" class="add-professor-btn">Add Exam</button>
                    </div>
                </form>
            </div>
        </div>
        {% endif %}

        <!-- RESULTS SECTION -->
        {% if active_page == 'results' %}
        <div id="dashh_result" class="dashh_mainpage">
            <div class="headinggg_dash_professor">
                <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Result</h2>
            </div>
            
            <div class="results-job-listings-grid">
                {% for exam in exams %}
                <div class="results-job-card-box">
                    <span class="results-job-category">{{ exam.course }}</span>
                    <span class="results-job-posted-time">{{ exam.result_count }} results</span>
                    <h3 class="results-job-title">{{ exam.code }}<br>{{ exam.professor }}</h3>
                    <a href="{% url 'exam_results' exam.id %}" class="results-job-view-link">View Result</a>
                </div>
                {% empty %}
                <div class="no-results">
                    <p>No exam results available.</p>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- EXAM RESULTS SECTION -->
        {% if active_page == 'exam_results' %}
        <div id="dashh_e" class="dashh_mainpage">
            <h2><img src="{% static 'images/less_thenarrow.svg' %}" alt="">Results for Exam {{ exam.exam_code }}</h2>
            
            <div class="dashh_mainregistered-container">
                <table class="dashh_mainstudents-table">
                    <tr>
                        <th>S.No</th>
                        <th>Username</th>
                        <th>Email id</th>
                        <th>Score</th>
                        <th>Correct Answers</th>
                        <th>Total Questions</th>
                        <th>Submitted At</th>
                    </tr>
                    {% for result in results %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ result.student_name }}</td>
                        <td>{{ result.student_name|lower|cut:" " }}@example.com</td>
                        <td>{{ result.score }}%</td>
                        <td>{{ result.correct_answers }}</td>
                        <td>{{ result.total_questions }}</td>
                        <td>{{ result.submitted_at|date:"d/m/Y H:i" }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" class="no-data">No results for this exam yet.</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
        {% endif %}

        <!-- Edit Exam Modal -->
<div id="editExamModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeEditExamModal()">&times;</span>
        <h2>Edit Exam</h2>
        <div class="modal-body">
            <form id="editExamForm" method="post">
                {% csrf_token %}
                <div class="form-group">
                    <label for="professor">Select Professor</label>
                    <select name="professor" id="professor" required>
                        {% for professor in professors %}
                        <option value="{{ professor.id }}">{{ professor.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="course">Select Course</label>
                    <select name="course" id="course" required>
                        {% for course in courses %}
                        <option value="{{ course.id }}">{{ course.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="difficulty">Select Difficulty</label>
                    <select name="difficulty" id="difficulty" required>
                        {% for difficulty in difficulties %}
                        <option value="{{ difficulty.id }}">{{ difficulty.difficulty_name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="num_questions">Number of Questions</label>
                    <input type="number" name="num_questions" id="num_questions" min="1" required>
                </div>
                <div class="form-group">
                    <label for="duration">Duration (minutes)</label>
                    <input type="number" name="duration" id="duration" min="5" required>
                </div>
                <div class="form-group">
                    <label for="start_time">Start Time</label>
                    <input type="datetime-local" name="start_time" id="start_time" required>
                </div>
                <div class="form-group">
                    <label for="end_time">End Time</label>
                    <input type="datetime-local" name="end_time" id="end_time" required>
                </div>
                <button type="submit" class="save-btn">Save Changes</button>
            </form>
        </div>
    </div>
</div>

<!-- Manual Question Form Modal -->
<!-- Manual Question Form Modal -->
<div id="manualQuestionModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeManualQuestionModal()">&times;</span>
        <h2>Add Questions Manually</h2>
        <div class="question-form-container">
            <form id="manualQuestionForm">
                {% csrf_token %}
                <input type="hidden" id="examId" name="exam_id">
                
                <div class="question-block">
                    <div class="form-group">
                        <label for="questionText">Question:</label>
                        <textarea id="questionText" name="question_text" rows="3" required placeholder="Enter your question text here"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Options:</label>
                        <div class="option-input">
                            <input type="radio" name="correct_option" id="optionA" value="A" required>
                            <label for="optionA">A:</label>
                            <input type="text" name="option_a" required placeholder="Option A">
                        </div>
                        <div class="option-input">
                            <input type="radio" name="correct_option" id="optionB" value="B">
                            <label for="optionB">B:</label>
                            <input type="text" name="option_b" required placeholder="Option B">
                        </div>
                        <div class="option-input">
                            <input type="radio" name="correct_option" id="optionC" value="C">
                            <label for="optionC">C:</label>
                            <input type="text" name="option_c" required placeholder="Option C">
                        </div>
                        <div class="option-input">
                            <input type="radio" name="correct_option" id="optionD" value="D">
                            <label for="optionD">D:</label>
                            <input type="text" name="option_d" required placeholder="Option D">
                        </div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="button" id="addAnotherQuestion" class="add-question-btn">Add Another Question</button>
                    <button type="submit" id="saveQuestionsBtn" class="save-btn">Save All Questions</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Add some CSS for better form handling -->

</body>
<script>// Create a simpler version of the "Add Another Question" functionality
// Core functions for professor management
function editProfessor(professorId) {
    fetch(`/university/professor/${professorId}/edit/`, {
        headers: {
            'X-Requested-With': 'XMLHttpRequest'
        }
    })
    .then(response => response.json())
    .then(data => {
        // Populate modal form with data
        const form = document.createElement('form');
        form.id = 'editProfessorForm';
        form.method = 'post';
        form.action = `/university/professor/${professorId}/edit/`;
        
        const csrfInput = document.createElement('input');
        csrfInput.type = 'hidden';
        csrfInput.name = 'csrfmiddlewaretoken';
        csrfInput.value = document.querySelector('[name=csrfmiddlewaretoken]').value;
        form.appendChild(csrfInput);
        
        // Create professor name field
        const nameGroup = document.createElement('div');
        nameGroup.className = 'form-group';
        const nameLabel = document.createElement('label');
        nameLabel.textContent = 'Professor Name';
        const nameInput = document.createElement('input');
        nameInput.type = 'text';
        nameInput.name = 'professor_name';
        nameInput.value = data.name;
        nameInput.required = true;
        nameGroup.appendChild(nameLabel);
        nameGroup.appendChild(nameInput);
        form.appendChild(nameGroup);
        
        // Create email field
        const emailGroup = document.createElement('div');
        emailGroup.className = 'form-group';
        const emailLabel = document.createElement('label');
        emailLabel.textContent = 'Email';
        const emailInput = document.createElement('input');
        emailInput.type = 'email';
        emailInput.name = 'email';
        emailInput.value = data.email;
        emailInput.required = true;
        emailGroup.appendChild(emailLabel);
        emailGroup.appendChild(emailInput);
        form.appendChild(emailGroup);
        
        // Create password field
        const passwordGroup = document.createElement('div');
        passwordGroup.className = 'form-group';
        const passwordLabel = document.createElement('label');
        passwordLabel.textContent = 'Password (leave empty to keep unchanged)';
        const passwordInput = document.createElement('input');
        passwordInput.type = 'password';
        passwordInput.name = 'password';
        passwordInput.placeholder = 'Enter new password to change';
        passwordGroup.appendChild(passwordLabel);
        passwordGroup.appendChild(passwordInput);
        form.appendChild(passwordGroup);
        
        // Create submit button
        const submitBtn = document.createElement('button');
        submitBtn.type = 'submit';
        submitBtn.className = 'btn btn-primary';
        submitBtn.textContent = 'Save Changes';
        form.appendChild(submitBtn);
        
        // Show modal
        showModal('Edit Professor', form);
    })
    .catch(error => console.error('Error fetching professor data:', error));
}

function deleteProfessor(professorId) {
    if (confirm('Are you sure you want to delete this professor?')) {
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        
        fetch(`/university/professor/${professorId}/delete/`, {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': csrfToken
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // Remove professor row from table
                const row = document.getElementById(`professor-row-${professorId}`);
                if (row) row.remove();
                
                // Show success message
                showToast('Professor deleted successfully');
            } else {
                showToast('Error deleting professor', 'error');
            }
        })
        .catch(error => {
            console.error('Error deleting professor:', error);
            showToast('Error deleting professor', 'error');
        });
    }
}

// Core functions for course management
function editCourse(courseId) {
    fetch(`/university/course/${courseId}/edit/`, {
        headers: {
            'X-Requested-With': 'XMLHttpRequest'
        }
    })
    .then(response => response.json())
    .then(data => {
        // Create form
        const form = document.createElement('form');
        form.id = 'editCourseForm';
        form.method = 'post';
        form.action = `/university/course/${courseId}/edit/`;
        
        const csrfInput = document.createElement('input');
        csrfInput.type = 'hidden';
        csrfInput.name = 'csrfmiddlewaretoken';
        csrfInput.value = document.querySelector('[name=csrfmiddlewaretoken]').value;
        form.appendChild(csrfInput);
        
        // Create course name field
        const nameGroup = document.createElement('div');
        nameGroup.className = 'form-group';
        const nameLabel = document.createElement('label');
        nameLabel.textContent = 'Course Name';
        const nameInput = document.createElement('input');
        nameInput.type = 'text';
        nameInput.name = 'course_name';
        nameInput.value = data.name;
        nameInput.required = true;
        nameGroup.appendChild(nameLabel);
        nameGroup.appendChild(nameInput);
        form.appendChild(nameGroup);
        
        // Create submit button
        const submitBtn = document.createElement('button');
        submitBtn.type = 'submit';
        submitBtn.className = 'btn btn-primary';
        submitBtn.textContent = 'Save Changes';
        form.appendChild(submitBtn);
        
        // Show modal
        showModal('Edit Course', form);
    })
    .catch(error => console.error('Error fetching course data:', error));
}

function deleteCourse(courseId) {
    if (confirm('Are you sure you want to delete this course?')) {
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        
        fetch(`/university/course/${courseId}/delete/`, {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': csrfToken
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // Remove course row from table
                const row = document.getElementById(`course-row-${courseId}`);
                if (row) row.remove();
                
                // Show success message
                showToast('Course deleted successfully');
            } else {
                showToast('Error deleting course', 'error');
            }
        })
        .catch(error => {
            console.error('Error deleting course:', error);
            showToast('Error deleting course', 'error');
        });
    }
}

// Core functions for difficulty management
document.addEventListener('DOMContentLoaded', function() {
    const addDifficultyBtn = document.getElementById('addDifficultyBtn');
    if (addDifficultyBtn) {
        addDifficultyBtn.addEventListener('click', function() {
            const difficultyName = document.getElementById('difficultyInput').value.trim();
            if (!difficultyName) {
                showToast('Please enter a difficulty name', 'error');
                return;
            }
            
            const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
            
            // Create form data
            const formData = new FormData();
            formData.append('difficulty_name', difficultyName);
            
            fetch('/university/difficulty/add/', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                    'X-CSRFToken': csrfToken
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    // Clear input
                    document.getElementById('difficultyInput').value = '';
                    
                    // Add new row to table
                    const tbody = document.getElementById('difficultyTableBody');
                    
                    // Remove "no difficulties" row if present
                    const noDataRow = document.getElementById('no-difficulties');
                    if (noDataRow) noDataRow.remove();
                    
                    // Count existing rows to determine new row number
                    const rowCount = tbody.querySelectorAll('tr').length + 1;
                    
                    const newRow = document.createElement('tr');
                    newRow.id = `difficulty-row-${data.id}`;
                    newRow.innerHTML = `
                        <td>${rowCount}</td>
                        <td>${data.name}</td>
                        <td>
                            <button class="edit-btn" onclick="editDifficulty(${data.id})">Edit</button>
                            <button class="delete-btn" onclick="deleteDifficulty(${data.id})">Delete</button>
                        </td>
                    `;
                    
                    tbody.appendChild(newRow);
                    showToast('Difficulty added successfully');
                } else {
                    showToast(data.message || 'Error adding difficulty', 'error');
                }
            })
            .catch(error => {
                console.error('Error adding difficulty:', error);
                showToast('Error adding difficulty', 'error');
            });
        });
    }
});

function editDifficulty(difficultyId) {
    fetch(`/university/difficulty/${difficultyId}/edit/`, {
        headers: {
            'X-Requested-With': 'XMLHttpRequest'
        }
    })
    .then(response => response.json())
    .then(data => {
        // Create edit form
        const form = document.createElement('form');
        form.id = 'editDifficultyForm';
        
        const csrfInput = document.createElement('input');
        csrfInput.type = 'hidden';
        csrfInput.name = 'csrfmiddlewaretoken';
        csrfInput.value = document.querySelector('[name=csrfmiddlewaretoken]').value;
        form.appendChild(csrfInput);
        
        // Create name field
        const nameGroup = document.createElement('div');
        nameGroup.className = 'form-group';
        const nameLabel = document.createElement('label');
        nameLabel.textContent = 'Difficulty Name';
        const nameInput = document.createElement('input');
        nameInput.type = 'text';
        nameInput.name = 'difficulty_name';
        nameInput.value = data.name;
        nameInput.required = true;
        nameGroup.appendChild(nameLabel);
        nameGroup.appendChild(nameInput);
        form.appendChild(nameGroup);
        
        // Create submit button
        const submitBtn = document.createElement('button');
        submitBtn.type = 'button';
        submitBtn.className = 'btn btn-primary';
        submitBtn.textContent = 'Save Changes';
        submitBtn.addEventListener('click', function() {
            updateDifficulty(difficultyId, nameInput.value.trim());
        });
        form.appendChild(submitBtn);
        
        // Show modal
        showModal('Edit Difficulty', form);
    })
    .catch(error => console.error('Error fetching difficulty data:', error));
}

function updateDifficulty(difficultyId, name) {
    if (!name) {
        showToast('Difficulty name is required', 'error');
        return;
    }
    
    const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
    
    // Create form data
    const formData = new FormData();
    formData.append('difficulty_name', name);
    
    fetch(`/university/difficulty/${difficultyId}/edit/`, {
        method: 'POST',
        body: formData,
        headers: {
            'X-Requested-With': 'XMLHttpRequest',
            'X-CSRFToken': csrfToken
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.status === 'success') {
            // Update row in table
            const row = document.getElementById(`difficulty-row-${difficultyId}`);
            if (row) {
                row.querySelector('td:nth-child(2)').textContent = data.name;
            }
            
            // Close modal
            closeModal();
            showToast('Difficulty updated successfully');
        } else {
            showToast(data.message || 'Error updating difficulty', 'error');
        }
    })
    .catch(error => {
        console.error('Error updating difficulty:', error);
        showToast('Error updating difficulty', 'error');
    });
}

function deleteDifficulty(difficultyId) {
    if (confirm('Are you sure you want to delete this difficulty?')) {
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        
        fetch(`/university/difficulty/${difficultyId}/delete/`, {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': csrfToken
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // Remove row from table
                const row = document.getElementById(`difficulty-row-${difficultyId}`);
                if (row) row.remove();
                
                // Show success message
                showToast('Difficulty deleted successfully');
            } else {
                showToast(data.message || 'Error deleting difficulty', 'error');
            }
        })
        .catch(error => {
            console.error('Error deleting difficulty:', error);
            showToast('Error deleting difficulty', 'error');
        });
    }
}

// Core functions for exam management
function openEditExamModal(examId) {
    // First, get the exam data
    fetch(`/university/get-exam-data/${examId}/`)
    .then(response => response.json())
    .then(examData => {
        // Update form action
        const form = document.getElementById('editExamForm');
        form.action = `/university/exam/${examId}/edit/`;
        
        // Fill form fields
        document.getElementById('professor').value = examData.professor_id;
        document.getElementById('course').value = examData.course_id;
        document.getElementById('difficulty').value = examData.difficulty_id;
        document.getElementById('num_questions').value = examData.num_questions;
        document.getElementById('duration').value = examData.duration;
        document.getElementById('start_time').value = examData.start_time;
        document.getElementById('end_time').value = examData.end_time;
        
        // Show modal
        document.getElementById('editExamModal').style.display = 'block';
    })
    .catch(error => {
        console.error('Error fetching exam data:', error);
        showToast('Error loading exam data', 'error');
    });
}

function closeEditExamModal() {
    document.getElementById('editExamModal').style.display = 'none';
}

// Functions for question management
function updateQuestions(examId) {
    const choice = confirm("Do you want to upload questions via CSV? Click OK for CSV upload, Cancel for manual entry.");

    if (choice) {
        // CSV upload flow
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.accept = '.csv';

        fileInput.onchange = function(e) {
            const file = e.target.files[0];
            if (file) {
                const formData = new FormData();
                formData.append('questions_csv', file);
                
                // Get CSRF token
                const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
                
                // Show loading message
                showToast("Uploading CSV file... Please wait.");
                
                fetch(`/university/upload_questions/${examId}/`, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-CSRFToken': csrfToken
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        showToast(`${data.count} questions uploaded successfully!`);
                        setTimeout(() => location.reload(), 1500);
                    } else {
                        showToast('Error: ' + data.message, 'error');
                    }
                })
                .catch(error => {
                    console.error('Error uploading questions:', error);
                    showToast(`Error uploading questions: ${error.message}`, 'error');
                });
            }
        };

        fileInput.click();
    } else {
        // Manual entry flow
        document.getElementById('examId').value = examId;
        
        // Clear existing questions
        const questionBlocks = document.querySelectorAll('.question-block');
        if (questionBlocks.length > 1) {
            // Remove all but the first question block
            for (let i = 1; i < questionBlocks.length; i++) {
                questionBlocks[i].remove();
            }
        }
        
        // Clear all separators
        document.querySelectorAll('.question-separator').forEach(function(sep) {
            sep.remove();
        });
        
        // Clear inputs in the first block
        const firstBlock = document.querySelector('.question-block');
        if (firstBlock) {
            firstBlock.querySelectorAll('input[type="text"], textarea').forEach(function(input) {
                input.value = '';
            });
            firstBlock.querySelectorAll('input[type="radio"]').forEach(function(radio) {
                radio.checked = false;
            });
        }
        
        // Show the modal
        document.getElementById('manualQuestionModal').style.display = 'block';
    }
}

// Question form handling
document.addEventListener('DOMContentLoaded', function() {
    // Add another question functionality
    const addQuestionBtn = document.getElementById('addAnotherQuestion');
    if (addQuestionBtn) {
        addQuestionBtn.addEventListener('click', function() {
            // Get the first question block
            const originalBlock = document.querySelector('.question-block');
            
            if (!originalBlock) return;
            
            // Clone it
            const newBlock = originalBlock.cloneNode(true);
            
            // Clear all input values in the clone
            newBlock.querySelectorAll('input[type="text"], textarea').forEach(function(input) {
                input.value = '';
            });
            
            // Uncheck radio buttons
            newBlock.querySelectorAll('input[type="radio"]').forEach(function(radio) {
                radio.checked = false;
            });
            
            // Create a unique identifier for the new question block
            const uniqueId = Date.now();
            
            // Update radio button names to make them a new group
            newBlock.querySelectorAll('input[type="radio"]').forEach(function(radio) {
                const oldId = radio.id;
                const newId = oldId + '_' + uniqueId;
                radio.id = newId;
                radio.name = 'correct_option_' + uniqueId;
                
                // Update the corresponding label
                const label = newBlock.querySelector(`label[for="${oldId}"]`);
                if (label) {
                    label.setAttribute('for', newId);
                }
            });
            
            // Create a separator
            const separator = document.createElement('hr');
            separator.className = 'question-separator';
            
            // Add separator and new block before the button group
            const buttonGroup = document.querySelector('.button-group');
            if (buttonGroup) {
                buttonGroup.parentNode.insertBefore(separator, buttonGroup);
                buttonGroup.parentNode.insertBefore(newBlock, buttonGroup);
            }
        });
    }
    
    // Form submission handler
    const questionForm = document.getElementById('manualQuestionForm');
    if (questionForm) {
        questionForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const examId = document.getElementById('examId').value;
            const questions = [];
            
            // Process each question block
            document.querySelectorAll('.question-block').forEach(function(block) {
                const questionText = block.querySelector('textarea[name="question_text"]')?.value?.trim();
                
                // Skip empty questions
                if (!questionText) return;
                
                const optionA = block.querySelector('input[name="option_a"]')?.value?.trim();
                const optionB = block.querySelector('input[name="option_b"]')?.value?.trim();
                const optionC = block.querySelector('input[name="option_c"]')?.value?.trim();
                const optionD = block.querySelector('input[name="option_d"]')?.value?.trim();
                
                // Find the selected radio button in this block
                let correctOption = '';
                block.querySelectorAll('input[type="radio"]').forEach(function(radio) {
                    if (radio.checked) {
                        correctOption = radio.value;
                    }
                });
                
                // Add question if all required fields are filled
                if (questionText && correctOption && optionA && optionB && optionC && optionD) {
                    questions.push({
                        question_text: questionText,
                        options: {
                            'A': optionA,
                            'B': optionB,
                            'C': optionC,
                            'D': optionD
                        },
                        correct_option: correctOption
                    });
                }
            });
            
            // Submit if we have questions
            if (questions.length > 0) {
                // Get CSRF token
                const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
                
                // Show loading message
                showToast("Saving questions... Please wait.");
                
                // Use relative URL with proper base path
                const apiUrl = `/university/exam/${examId}/add-questions-manually/`;
                
                // Send the request
                fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': csrfToken
                    },
                    body: JSON.stringify(questions)
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Server responded with ${response.status}: ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.status === 'success') {
                        showToast(`${data.count} questions added successfully!`);
                        // Close the modal
                        document.getElementById('manualQuestionModal').style.display = 'none';
                        // Reload the page
                        location.reload();
                    } else {
                        showToast('Error: ' + data.message, 'error');
                    }
                })
                .catch(error => {
                    console.error('Error submitting questions:', error);
                    showToast('Error submitting questions: ' + error.message, 'error');
                });
            } else {
                showToast('Please add at least one complete question with a correct option selected.', 'error');
            }
        });
    }
});

function closeManualQuestionModal() {
    const modal = document.getElementById('manualQuestionModal');
    if (modal) modal.style.display = 'none';
}

// Utility functions
function showModal(title, content) {
    // Create modal container if it doesn't exist
    let modal = document.getElementById('customModal');
    if (!modal) {
        modal = document.createElement('div');
        modal.id = 'customModal';
        modal.className = 'modal';
        
        const modalContent = document.createElement('div');
        modalContent.className = 'modal-content';
        
        const closeBtn = document.createElement('span');
        closeBtn.className = 'close';
        closeBtn.innerHTML = '&times;';
        closeBtn.onclick = closeModal;
        
        const modalTitle = document.createElement('h2');
        modalTitle.id = 'modalTitle';
        
        const modalBody = document.createElement('div');
        modalBody.id = 'modalBody';
        modalBody.className = 'modal-body';
        
        modalContent.appendChild(closeBtn);
        modalContent.appendChild(modalTitle);
        modalContent.appendChild(modalBody);
        modal.appendChild(modalContent);
        
        document.body.appendChild(modal);
    }
    
    // Update modal content
    document.getElementById('modalTitle').textContent = title;
    
    const modalBody = document.getElementById('modalBody');
    modalBody.innerHTML = '';
    
    if (typeof content === 'string') {
        modalBody.innerHTML = content;
    } else {
        modalBody.appendChild(content);
    }
    
    // Show modal
    modal.style.display = 'block';
}

function closeModal() {
    const modal = document.getElementById('customModal');
    if (modal) modal.style.display = 'none';
}

function showToast(message, type = 'success') {
    // Create toast container if it doesn't exist
    let toastContainer = document.getElementById('toastContainer');
    if (!toastContainer) {
        toastContainer = document.createElement('div');
        toastContainer.id = 'toastContainer';
        document.body.appendChild(toastContainer);
        
        // Add styles
        const style = document.createElement('style');
        style.textContent = `
            #toastContainer {
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 9999;
            }
            
            .toast {
                padding: 12px 20px;
                margin-bottom: 10px;
                border-radius: 4px;
                color: white;
                opacity: 0;
                transition: opacity 0.3s ease;
            }
            
            .toast.show {
                opacity: 1;
            }
            
            .toast.success {
                background-color: #4CAF50;
            }
            
            .toast.error {
                background-color: #F44336;
            }
        `;
        document.head.appendChild(style);
    }
    
    // Create toast
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.textContent = message;
    
    // Add to container
    toastContainer.appendChild(toast);
    
    // Show toast
    setTimeout(() => toast.classList.add('show'), 10);
    
    // Auto-remove after delay
    setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 300);
    }, 3000);
}

// Add some basic CSS for the question form
document.addEventListener('DOMContentLoaded', function() {
    const style = document.createElement('style');
    style.textContent = `
        .question-block {
            margin-bottom: 15px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        
        .option-input {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .option-input input[type="radio"] {
            margin-right: 8px;
        }
        
        .option-input label {
            margin-right: 8px;
            min-width: 20px;
        }
        
        .option-input input[type="text"] {
            flex-grow: 1;
        }
        
        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .question-separator {
            margin: 20px 0;
            border: 0;
            border-top: 1px dashed #999;
        }
        
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 600px;
            border-radius: 5px;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
        }
    `;
    document.head.appendChild(style);
});
</script>
</html>